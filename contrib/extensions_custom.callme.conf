#include b24_continuous_parallel.conf

[from-internal-custom]
#include extensions_custom.postmet.conf

exten => 800018,1,Set(CALLERID(name)=Moldova)
exten => 800018,n,Goto(from-trunk,${EXTEN},1)

exten => 800366,1,Set(CALLERID(name)=Moldova)
exten => 800366,n,Goto(from-trunk,${EXTEN},1)

exten => 119,1,Goto(outbound-allroutes,9261654173,1)

exten => _11[78],1,Macro(user-callerid)
;exten => _11[78],1,SET(CALLERID(name)=242: 242-orphey.postmet.local)
;exten => _11[78],n,SET(CALLERID(num)=0242${CALLERID(num)})
exten => _11[78],n,Dial(IAX2/posttun/${EXTEN})

exten => 109,1,Macro(user-callerid)
;exten => _109,1,SET(CALLERID(name)=242: 242-orphey.postmet.local)
;exten => _109,n,SET(CALLERID(num)=0242${CALLERID(num)})
exten => 109,n,Dial(IAX2/posttun/${EXTEN})

exten => _0ZX.,1,SET(CALLERID(name)=242: 242-orphey.postmet.local)
exten => _0ZX.,n,SET(CALLERID(num)=0242${CALLERID(num)})
exten => _0ZX.,n,Dial(IAX2/posttun/${EXTEN})

exten => _00373ZX.,1,SET(CALLERID(name)=242: 242-orphey.postmet.local)
exten => _00373ZX.,n,SET(CALLERID(num)=0242${CALLERID(num)})
exten => _00373ZX.,n,Dial(IAX2/posttun/${EXTEN})

;exten => _0ZX./109,1,Set(CALLERID(all)=242-orphey.postmet.local <0242109>)
;;exten => _0ZX./109,n,SET(CALLERID(num)=0242${CALLERID(num)})
;exten => _0ZX./0242109,n,NoOp(Caller id is ${CALLERID(all)})
;exten => _0ZX./0242109,n,Dial(IAX2/posttun/${EXTEN})

;exten => 217,1,SET(CALLERID(name)=242: 242-orphey.postmet.local)
;same  => n,SET(CALLERID(num)=0242${CALLERID(num)})
;same  => n,Dial(IAX2/posttun/117)

;exten => 121,1,Progress()
;exten => 121,2,Dial(SIP/121,,t)

[from-pstn-custom]
exten => _X.,1,NoOp(===========RDNIS=${SIP_HEADER(Diversion)}============)
exten => _X.,2,NoOp(===== Усекновение главы Иоанна Крестителя ===== DID=${SIP_HEADER(Diversion):5:11}============)
exten => _X.,3,Set(__FROM_DID=${SIP_HEADER(Diversion):5:11})
exten => _X.,n,ExecIf($["${FROM_DID}" = "roistat@sle"]?GoTo(ext-did,74952150561,1)) ; Exclude for Roistat
exten => _X.,n,ExecIf($["${FROM_DID}" = "roistat_nad"]?GoTo(ext-did,74952120901,1)) ; Exclude for Roistat
exten => _X.,n,ExecIf($["${FROM_DID}" = "roistat_spb"]?GoTo(ext-did,78123855548,1)) ; Exclude for Roistat

; 20.04.2023
exten => _X.,n,ExecIf($["${FROM_DID}" = "73812218987"]?GoTo(ext-did,74952150561,1)) ; Exclude for Roistat
exten => _X.,n,ExecIf($["${FROM_DID}" = "73852590752"]?GoTo(ext-did,74952150561,1)) ; Exclude for Roistat
exten => _X.,n,ExecIf($["${FROM_DID}" = "78722709562"]?GoTo(ext-did,74952150561,1)) ; Exclude for Roistat

exten => _X.,n,ExecIf($["${FROM_DID}" = "74995044374"]?Set(CALLERID(name)=Волоколамка))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78123855548"]?Set(CALLERID(name)=С. Петербург-ВС))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78124253792"]?Set(CALLERID(name)=С. Петербург-НC))
exten => _X.,n,ExecIf($["${FROM_DID}" = "74232026637"]?Set(CALLERID(name)=Владивосток))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78442962147"]?Set(CALLERID(name)=Волгоград))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73432887437"]?Set(CALLERID(name)=Екатеринбург))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73952480437"]?Set(CALLERID(name)=Иркутск))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78432122367"]?Set(CALLERID(name)=Казань))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78612052637"]?Set(CALLERID(name)=Краснодар))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73919865527"]?Set(CALLERID(name)=Красноярск))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78312621857"]?Set(CALLERID(name)=Нижний Новгород))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73833884684"]?Set(CALLERID(name)=Новосибирск))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73422482347"]?Set(CALLERID(name)=Пермь))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78633221137"]?Set(CALLERID(name)=Ростов-на-Дону))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78462129867"]?Set(CALLERID(name)=Самара))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78452397837"]?Set(CALLERID(name)=Саратов))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78625552567"]?Set(CALLERID(name)=Сочи))
exten => _X.,n,ExecIf($["${FROM_DID}" = "78482686637"]?Set(CALLERID(name)=Тольятти))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73452578762"]?Set(CALLERID(name)=Тюмень))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73472009937"]?Set(CALLERID(name)=Уфа))
exten => _X.,n,ExecIf($["${FROM_DID}" = "74212988837"]?Set(CALLERID(name)=Хабаровск))
exten => _X.,n,ExecIf($["${FROM_DID}" = "73517008857"]?Set(CALLERID(name)=Челябинск))
exten => _X.,n,ExecIf($["${FROM_DID}" = "77172696743"]?Set(CALLERID(name)=Нур-Султан))

exten => _X.,n,Goto(ext-did,${FROM_DID},1)

;exten => 74951500732,1,Goto(from-internal-custom,119,1)
;exten => 74951500732,1,Dial(SIP/m4952120901/79261654173) ; Alexander
exten => 74951500732,1,Dial(SIP/m4952120901/79264917078) ; Oksana

; CallMe integration expects override file `extensions_override_freepbx.callme.conf`
; to be deployed alongside this file.
